version: '3.8'

# Exemplo de uso do Webhook Tunnel com Docker Compose
# Este exemplo mostra como integrar o tunnel com seus serviços

services:
  # Sua API
  api:
    image: node:18-alpine
    working_dir: /app
    command: npm start
    ports:
      - "3000:3000"
    volumes:
      - ./api:/app
    environment:
      - NODE_ENV=development
      - PORT=3000

  # Serviço de webhook receiver
  webhook-receiver:
    image: python:3.11-slim
    working_dir: /app
    command: python app.py
    ports:
      - "3001:3001"
    volumes:
      - ./webhook-receiver:/app
    environment:
      - FLASK_ENV=development
      - PORT=3001

  # Nginx como proxy (opcional)
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - api
      - webhook-receiver

# Após iniciar os containers:
# docker-compose up -d
#
# Exponha as portas com tunnel:
# tunnel start api 3000 --subdomain api
# tunnel start webhooks 3001 --subdomain webhooks
#
# Acesse:
# http://api.localhost:8000
# http://webhooks.localhost:8001
